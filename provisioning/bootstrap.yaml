# Install Java 17
- name: Provision
  hosts: all
  become: yes
  tasks:
    - name: Get JDK 17
      get_url:
        url: https://download.java.net/java/GA/jdk17/0d483333a00540d886896bac774ff48b/35/GPL/openjdk-17_linux-x64_bin.tar.gz
        dest: /opt/
    - name : Ensure JDK 17 directory exists
      file:
        path: /opt/jdk-17
        state: directory
    - name: unarchive JDK 17
      unarchive:
        src: /opt/openjdk-17_linux-x64_bin.tar.gz
        dest: /opt/
        remote_src: yes
        list_files: yes

# Set JAVA_HOME and PATH
    - name: Adding the java_home
      lineinfile: dest=/home/vagrant/.bashrc line='export JAVA_HOME=/opt/jdk-17' insertafter='EOF' state=present
    - name: Add path
      lineinfile: dest=/home/vagrant/.bashrc line='export PATH=$PATH:/opt/jdk-17/bin' insertafter='EOF' state=present
    - name: Source the profile file
      shell: source /home/vagrant/.bashrc executable=/bin/bash